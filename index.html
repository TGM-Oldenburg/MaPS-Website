<!doctype HTML>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>PESTO</title>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <script src="fft.js"></script>
        <script src="plotly-latest.min.js"></script>
        <script src="pesto.js"></script>

        <header>
            <h1>Pesto: Accurate Pitch Estimation in the Magnitude and Phase Spectrogram</h1>
        </header>

        <article>
            <p class="abstract">This paper presents a new algorithm (PESTO) for estimating the
                fundamental frequency of human voices using both the magnitude and phase
                spectrogram. In order to evaluate the accuracy of the new algorithm, several
                variants of PESTO are compared to one another, and to the reference algorithms YIN,
                RAPT, and PEFAC on a large database of speech recordings and background noises. The
                evaluation shows that PESTO outperforms these algorithms, both in terms of
                fundamental frequency estimation precision and voice activity detection accuracy.
                Additional experiments evaluate PESTO's performance for different pitch frequencies,
                noise types, and reverberation. At positive signal to noise ratios, PESTO reaches
                close to 100&nbsp;% fundamental frequency estimation precision and 90&nbsp;% voice
                activity detection accuracy across the entire dataset.</p>

            <div id="introspectrogram"></div>


            <h2>Code</h2>

            <p>You can download free implementations of PESTO in Python, Matlab, and Julia by
            cloning this repository:</p>
            <code>git clone foo@bar.pesto.git</code>
            <p>The code is released under the terms of the
                <a href="https://opensource.org/licenses/BSD-3-Clause">BSD 3-clause license</a>,
                © 2016, Bastian Bechtold, Jade Hochschule</p>


            <h2>PESTO-M: Correlating Templates with the Magnitude Spectrum</h2>

            <p>PESTO-M correlates a number of template spectra at different fundamental frequencies
                with the signal magnitude spectrum. The point of highest correlation is the
                estimated fundamental frequency</p>

            <div id="pestom"></div>
            <script src="pestom.js"></script>
            <form style="text-align:center;">
                <label>estimated fundamental frequency:</label>
                <label class="value" id="PESTO-M:value">loading</label><br>
                <label class="start">80 Hz</label>
                <input id="PESTO-M:slider" type="range"
                       name="fundamental frequency"
                       min="80" max="450" step="5" value ="150"
                       onchange="updatePESTOM(this.value);"
                       oninput="document.getElementById('PESTO-M:value').innerHTML = this.value + ' Hz';"
                       style="width:150px;">
                <label class="stop">450 Hz</label>
            </form>

            <p>At about 115 Hz, all the peaks in the template match up with the peaks in the
                spectrum, and the magnitude correlation reaches its maximum. This frequency is the
                estimated fundamental frequency for this spectrum.</p>


            <h2>PESTO-P: Subtracting Templates from the Instantaneous Frequency Deviation</h2>

            <p> This variant is the Instantanous Frequency Deviation (IFD), which is IF(f)-f, where
                IF is the Instantanous Frequency, or time-derivative of the phase spectrum.</p>

            <div id="ifd"></div>
            <script>display_ifd("Mann_short.wav", "ifd", [650, 300])</script>

            <p>In the IFD, speech is represented by a sawtooth pattern. PESTO-P subtracts a number
                of template spectra at different fundamental frequencies from the IFD. The point of
                lowest difference is the estimated fundamental frequency.</p>

            <div id="pestop"></div>
            <script src="pestop.js"></script>
            <form style="text-align:center;">
                <label>estimated fundamental frequency:</label>
                <label class="value" id="PESTO-P:value">loading</label><br>
                <label class="start">80 Hz</label>
                <input id="PESTO-P:slider" type="range"
                       name="fundamental frequency"
                       min="80" max="450" step="5" value ="150"
                       onchange="updatePESTOP(this.value);"
                       oninput="document.getElementById('PESTO-P:value').innerHTML = this.value + ' Hz';"
                       style="width:150px;">
                <label class="stop">450 Hz</label>
            </form>

            <p>At about 115 Hz, all the zeros in the template match up with the zeros in the
                spectrum, and the IFD difference reaches its maximum. This frequency is the
                estimated fundamental frequency for this spectrum.</p>


            <h2>PESTO: Maximum A Posteriori Combination of Magnitude Correlation and IFD Difference</h2>

            <p>PESTO combines the magnitude correlation from PESTO-M with the IFD difference from
                PESTO-P in a Bayesan maximum a posteriori fundamental frequency estimator. You can
                see the results of this estimation on a few speech signals from the
                <a href="https://www.spsc.tugraz.at/tools/ptdb-tug">PTDB-TUG</a>
                database and noises from the <a href="http://eprints.qut.edu.au/85240/">QUT-NOISE</a>
                corpus in the next figure:</p>

            <div id="pesto"></div>
            <select id="PESTO:speaker" style="text-align:center;" onchange="refresh_pesto()">
                <option value="male1">Male Speaker</option>
                <option value="female2" selected>Female Speaker</option>
            </select>
            <select id="PESTO:snr" style="text-align:center;" onchange="refresh_pesto()">
                <option value="40">40 dB SNR</option>
                <option value="35">35 dB SNR</option>
                <option value="30">30 dB SNR</option>
                <option value="25">25 dB SNR</option>
                <option value="20">20 dB SNR</option>
                <option value="15">15 dB SNR</option>
                <option value="10" selected>10 dB SNR</option>
                <option value="5">5 dB SNR</option>
                <option value="0">0 dB SNR</option>
                <option value="-5">-5 dB SNR</option>
                <option value="-10">-10 dB SNR</option>
                <option value="-15">-15 dB SNR</option>
                <option value="-20">-20 dB SNR</option>
            </select>
            <select id="PESTO:noise" style="text-align:center;" onchange="refresh_pesto()">
                <option value="cafeteria">Cafeteria Noise</option>
                <option value="white">White Noise</option>
                <option value="traffic">Traffic Noise</option>
                <option value="car" selected>Driving Noise</option>
            </select>
            <audio id="PESTO:player" controls></audio>

            <p>This figure shows PESTO's strengths and limitations. On the one hand, PESTO estimates
                speech fundamental frequencies with very high precision and very rarely selects
                non-pitched values as pitched. On the other hand, this precision leads to less
                accuracy, and some pitched frames are not recognized. This is a trade-off that is
                configurable through a parameter.</p>


            <h2>Evaluation</h2>

            <p>The fundamental frequency estimation performance of PESTO was evaluated using a large
                database of f<sub>0</sub>-annotated speech recordings from the PTDB-TUG corpus, and
                acoustic noise recordings from the QUT-NOISE corpus.</p>

            <p>Additionally, the PESTO's performance was compared against the well-known fundamental
                frequency estimation algorithms PEFAC, RAPT, and YIN. The error measures for this
                evaluation are:</p>

            <dl>
                <dt>Gross Pitch Error</dt><dd>Percentage of frames that are correctly classified as
                    pitched, and whose pitch is within 20% of the true pitch.</dd>
                <dt>Fine Pitch Error</dt><dd>Mean error of pitch estimates that are within 20%.</dd>
            </dl>

            <div id="pesto-gpe"></div><div id="pesto-fpe"></div>
            <script src="pesto-compare.js"></script>

            <p>Thus, PESTO achieves almost 100% precision at positive signal to noise ratios.</p>

        </article>

        <footer><p>© 2016, Bechtold, van de Par, Bitzer. All rights reserved</p></footer>

    </body>
</html>
