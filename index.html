<!doctype HTML>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>PESTO</title>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <script src="fft.js"></script>
        <script src="plotly-latest.min.js"></script>
        <script src="pesto.js"></script>

        <header>
            <h1>Pesto: Accurate Pitch Estimation in the Magnitude and Phase Spectrogram</h1>
        </header>

        <article>
            <p><i>This is the website for a paper that is currently in review. As soon as the
            paper has passed review, source code for PESTO will be made available here. Until then,
            only examples and a brief description are published here.</i></p>

            <p class="abstract">This website presents a new algorithm (PESTO) for estimating the
            fundamental frequency of human voices using both the magnitude and phase spectrogram. In
            order to evaluate the accuracy of the new algorithm, several variants of PESTO are
            compared to one another, and to the reference algorithms YIN, RAPT, and PEFAC on a large
            database of speech recordings and background noises. The evaluation shows that PESTO
            outperforms these algorithms, both in terms of fundamental frequency estimation
            precision and voice activity detection accuracy. Additional experiments evaluate PESTO's
            performance for different pitch frequencies, noise types, and reverberation. At positive
            signal to noise ratios, PESTO reaches close to 100&thinsp;% fundamental frequency
            estimation precision and 90&thinsp;% voice activity detection accuracy across the entire
            dataset.</p>

            <div id="introspectrogram"></div>


            <h2>Code</h2>

            <p>Source code for PESTO in Python, Matlab, and Julia can be downloaded by
            cloning this repository:</p>
            <p><i>Code examples will be made available here as soon as the paper has passed
            review.</i></p>
            <!-- <code>git clone git@tgm-git.jade-hs.de:bastianbechtold/pesto.git</code> -->
            <p>The code is released under the terms of the
            <a href="https://opensource.org/licenses/BSD-3-Clause">BSD 3-clause license</a>, © 2016,
            Bastian Bechtold, Jade Hochschule. This means that the source code can be read, used,
            and modified freely, as long as our authorship of the code is recognized. Additionally,
            we kindly request feedback on how the code is used.</p>


            <h2>PESTO-M: Correlating Templates with the Magnitude Spectrum</h2>

            <p>PESTO-M correlates a number of template spectra at different fundamental frequencies
            with the signal magnitude spectrum. The point of highest correlation is the estimated
            fundamental frequency:</p>

            <div id="pestom"></div>
            <script src="pestom.js"></script>
            <form style="text-align:center;">
                <label>estimated fundamental frequency:</label>
                <label class="value" id="PESTO-M:value">loading</label><br>
                <label class="start">80&thinsp;Hz</label>
                <input id="PESTO-M:slider" type="range"
                       name="fundamental frequency"
                       min="80" max="450" step="5" value ="150"
                       oninput="updatePESTOM(this.value);"
                       style="width:150px;">
                <label class="stop">450&thinsp;Hz</label>
            </form>

            <p>At about 115&thinsp;Hz, all the peaks in the template match up with the peaks in the
            spectrum, and the magnitude correlation reaches its maximum. That frequency is the
            estimated fundamental frequency for this spectrum.</p>


            <h2>PESTO-P: Subtracting Templates from the Instantaneous Frequency Deviation</h2>

            <p>PESTO-P works on a variant of the phase spectrum, called the Instantanous Frequency
            Deviation (IFD), which is IF(f)-f, or the difference between the Instantanous Frequency
            IF(f) and the frequency f. The IF(f) is the time-derivative of the phase spectrum.</p>

            <p>The IFD for the same speech signal as discussed in the introduction looks like
            this:</p>

            <div id="ifd"></div>
            <script>display_ifd("Mann_short.wav", "ifd", [650, 300])</script>

            <p>In the IFD, speech is represented by a sawtooth pattern. PESTO-P subtracts a number
            of template spectra at different fundamental frequencies from the IFD. The point of
            lowest difference is the estimated fundamental frequency:</p>

            <div id="pestop"></div>
            <script src="pestop.js"></script>
            <form style="text-align:center;">
                <label>estimated fundamental frequency:</label>
                <label class="value" id="PESTO-P:value">loading</label><br>
                <label class="start">80&thinsp;Hz</label>
                <input id="PESTO-P:slider" type="range"
                       name="fundamental frequency"
                       min="80" max="450" step="5" value ="150"
                       oninput="updatePESTOP(this.value);"
                       style="width:150px;">
                <label class="stop">450&thinsp;Hz</label>
            </form>

            <p>At about 115&thinsp;Hz, all the zeros in the template match up with the zeros in the
            spectrum, and the IFD difference reaches its maximum. This frequency is the estimated
            fundamental frequency for this spectrum.</p>


            <h2>PESTO: Maximum A Posteriori Combination of Magnitude Correlation and IFD Difference</h2>

            <p>PESTO combines the magnitude correlation from PESTO-M with the IFD difference from
            PESTO-P in a Bayesan maximum a posteriori fundamental frequency estimator. The results
            of this estimation on a few speech signals from the
            <a href="https://www.spsc.tugraz.at/tools/ptdb-tug">PTDB-TUG</a> database and noises
            from the <a href="http://eprints.qut.edu.au/85240/">QUT-NOISE</a> corpus can be seen in
            the following figure:</p>

            <div id="pesto"></div>
            <select id="PESTO:speaker" style="text-align:center;" onchange="refresh_pesto()">
                <option value="male1">Male Speaker</option>
                <option value="female2" selected>Female Speaker</option>
            </select>
            <select id="PESTO:snr" style="text-align:center;" onchange="refresh_pesto()">
                <option value="40">40&thinsp;dB SNR</option>
                <option value="35">35&thinsp;dB SNR</option>
                <option value="30">30&thinsp;dB SNR</option>
                <option value="25">25&thinsp;dB SNR</option>
                <option value="20">20&thinsp;dB SNR</option>
                <option value="15">15&thinsp;dB SNR</option>
                <option value="10" selected>10&thinsp;dB SNR</option>
                <option value="5">5&thinsp;dB SNR</option>
                <option value="0">0&thinsp;dB SNR</option>
                <option value="-5">-5&thinsp;dB SNR</option>
                <option value="-10">-10&thinsp;dB SNR</option>
                <option value="-15">-15&thinsp;dB SNR</option>
                <option value="-20">-20&thinsp;dB SNR</option>
            </select>
            <select id="PESTO:noise" style="text-align:center;" onchange="refresh_pesto()">
                <option value="cafeteria">Cafeteria Noise</option>
                <option value="white">White Noise</option>
                <option value="traffic">Traffic Noise</option>
                <option value="car" selected>Driving Noise</option>
            </select>
            <audio id="PESTO:player" controls></audio>

            <p>This figure shows how PESTO accurately recognizes the base frequency track in noisy
            speech recordings. In general, PESTO prefers high precision over high recall, and thus
            accepts some false negatives in favor of too many false positives. For many
            applications, this is advantageous, since it is more important to obtain
            <emph>reliable</emph> answers than to obtain plentiful answers. This is a trade-off that
            is configurable through a detection threshold parameter.</p>


            <h2>Evaluation</h2>

            <p>The fundamental frequency estimation performance of PESTO was evaluated using a large
            database of f<sub>0</sub>-annotated speech recordings from the
            <a href="https://www.spsc.tugraz.at/tools/ptdb-tug">PTDB-TUG</a> corpus, and acoustic
            noise recordings from the <a href="http://eprints.qut.edu.au/85240/">QUT-NOISE</a>
            corpus.</p>

            <p>Additionally, the PESTO's performance was compared against the well-known fundamental
            frequency estimation algorithms <a href="http://dx.dio.org/10.1109/TASLP.2013.2295918">
            PEFAC</a>, <a href="http://www.ee.columbia.edu/~dpwe/papers/Talkin95-rapt.pdf">RAPT</a>,
            and <a href="http://dx.dio.org/10.1121/1.1458024">YIN</a>. The error measures for this
            evaluation are:</p>

            <dl>
                <dt>Gross Pitch Error</dt><dd>Percentage of frames that are correctly classified as
                    pitched, and whose pitch is within 20&thinsp;% of the true pitch.</dd>
                <dt>Fine Pitch Error</dt><dd>Mean error of pitch estimates that are within 20&thinsp;%.</dd>
            </dl>

            <div id="pesto-gpe"></div><div id="pesto-fpe"></div>
            <script src="pesto-compare.js"></script>

            <p>Thus, PESTO achieves almost 100&thinsp;% precision at positive signal to noise
            ratios.</p>

            <p>For further information, a full definition of the algorithm, and a more thorough
            evaluation, please read the paper at <i>(link will be inserted here once published)
            </i>.</p>

        </article>

        <footer><p>© 2016, Bechtold, van de Par, Bitzer. All rights reserved</p></footer>

    </body>
</html>
